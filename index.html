<!DOCTYPE html>
<html>
<head>
    <title>Temps d'attente STIB</title>
    <script>
        async function fetchTimes() {
            const stopId = '8672'; // Remplacez par l'ID de votre arrêt
            const apiKey = '873665222d89adf30a4d2fbaad9f8976e4515d32d6892b73f886b0e4'; // Ajoutez votre clé API

            try {
                const response = await fetch(`https://api.stib-mivb.be/OperationMonitoring/4.0/Passages/${stopId}`, {
                    headers: {
                        'Authorization': `Bearer ${apiKey}`
                    }
                });
                if (!response.ok) {
                    throw new Error('Erreur lors de la récupération des données');
                }
                const data = await response.json();
                displayTimes(data);
            } catch (error) {
                console.error('Erreur :', error);
            }
        }

        function displayTimes(data) {
            const container = document.getElementById('times');
            container.innerHTML = '';
            data['lines'].forEach(line => {
                const nextPassages = line['passingTimes'].map(passage => 
                    `Ligne ${line['lineId']} - Prochain passage : ${passage['expectedArrivalTime']}`
                ).join('<br>');
                container.innerHTML += `<p>${nextPassages}</p>`;
            });
        }

        window.onload = fetchTimes;
    </script>
</head>
<body>
    <h1>Temps d'attente à l'arrêt</h1>
    <div id="times"></div>
</body>
</html>
